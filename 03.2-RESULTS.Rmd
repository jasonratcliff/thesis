
```{r chapterSectionCarbonVitu}

knitr_section(knitr_title = "Status of *Physaria vitulifera* in Wyoming",
              knitr_type = "section")
```

\paragraph{} While the phylogeny from the sampled loci for the specimens considered was not fully resolved, evidence for separation of the disputed *P. vitulifera* specimens as a new taxon (henceforth *Physaria medicinae*) was observed in morphological and ecological traits.  Reviewed specimens are found generally above 2,100m, at a higher elevation relative to nearby *P. acutifolia* and allopatric *P. vitulifera* of Colorado (Figure \@ref(fig:resultsFigure6ElevationCarbonVitu)).  Plotting the specimens from Figure \@ref(fig:introFigure2MapCarbonWyoVitu) over an elevation profile illustrates the geographic distance between the putative Carbon County specimens and those of *P. vitulifera* from East of the Front Range (Figure \@ref(fig:resultsFigure7ElevationProfileMedicinae)).  Populations of questioned specimens examined are distributed from the Sierra Madre West of Encampment and East through the Medicine Bow Range.  After accounting for collection date, these specimens also show a marked reduction in average mature fruit length and width relative to other nearby species (Figure \@ref(fig:resultsFigure8FruitDimCarbonVitu)).

```{r resultsFigure6ElevationCarbonVitu, fig.width=5, fig.asp=1, fig.cap=knitr_cap}

knitr_cap <-
  paste0("Elevation differences between questioned Carbon County, WY specimens",
         " and nearby *Physaria* species.")

# Substitute new taxon name for putative species.
spp_carbon_wyo$Taxon_a_posteriori <-
  gsub("Physaria acutifolia - vitulifera-like", "Physaria medicinae",
       spp_carbon_wyo$Taxon_a_posteriori) %>%
  gsub("Physaria vitulifera - Carbon", "Physaria medicinae", x = .)

# Filter specimens from Carbon, WY subset by species identification.
spp_carbon_medi <-
  dplyr::filter(spp_carbon_wyo,
                grepl("Physaria$|vitulifera|acutifolia|medicinae",
                      Taxon_a_posteriori)) %>%
  dplyr::filter(., !grepl("\\?", Taxon_a_posteriori))

# Parse elevation data to remove commas and "s.n." as missing (i.e. NA).
spp_carbon_elev <-
  dplyr::mutate(.data = spp_carbon_medi,
                elev_ft = gsub(",", "", x = spp_carbon_medi$`Elev_(ft.)`) %>%
                  gsub("s.n.", NA, x = .)) %>%
  continuous_tbl(trait_frame = ., trait_name = "elev_ft") %>%
  dplyr::filter(., Taxon_a_posteriori != "Physaria")

# Plot of elevation by reviewed species identification.
ggplot(data = spp_carbon_elev,
       mapping = aes(x = Taxon_a_posteriori, y = trait_mid,
                     colour = Taxon_a_posteriori,
                     shape = Taxon_a_posteriori)) +
  geom_violin(na.rm = TRUE) +
  geom_jitter(width = 0.1, na.rm = TRUE) +
  scale_y_continuous(name = "Elevation (ft.)") +
  scale_x_discrete(name = NULL, labels = NULL) +
  scale_color_manual("Reviewed Annotations", values = spp_color) +
  scale_shape_manual("Reviewed Annotations", values = spp_shape) +
  theme(legend.box = "vertical", legend.position = "bottom",
        legend.direction = "vertical", legend.title.align = 0.5) +
  guides(colour = guide_legend(ncol = 2, byrow = TRUE))

```

\clearpage

```{r resultsFigure7ElevationProfileMedicinae, fig.width=8, fig.asp=0.9, fig.cap=knitr_cap}

set.seed(2018)
knitr_cap <-
  "Elevation profile of reported Carbon County, WY *Physaria vitulifera*."

# Elevation profile map of Carbon, WY specimens.
(map_elev(map_df = spp_carbon_wyo, gg_borders = gg_borders,
          map_col = "Taxon_a_posteriori",
          raster_zoom = 7, raster_factor = 1)) %>%
  map_themes(gg_map_obj = .)

```

\clearpage

```{r resultsFigure8FruitDimCarbonVitu, fig.width=8, fig.asp=1, fig.cap=knitr_cap}

# Plot of fruit dimensions by reviewed species ID and collection date.
knitr_cap <-
  paste0("Mature fruit dimensions by collection date of putative Wyoming",
         " *Physaria vitulifera* specimens.")

# Build fruit length graph.
trait_carbon_fr_len <-
  continuous_tbl(trait_frame = spp_carbon_medi,
                 trait_name = "Mature_fruit_length_mm") %>%
  ggplot(.,
         aes(Date_md, trait_mid,
             colour = Taxon_a_posteriori,
             shape = Taxon_a_posteriori)) +
  geom_point(na.rm = TRUE, size = 3) +
  geom_smooth(method = 'lm', formula = y~x, na.rm = TRUE) +
  scale_y_continuous(name = "Mature Fruit Length (mm)", limits = c(0, 15)) +
  scale_x_date(name = "Collection Date", date_labels = "%m-%d",
               limits = as.Date(c("2019-05-01", "2019-09-01"),
                                format = "%Y-%m-%d")) +
  scale_color_manual("Reviewed Annotations", values = spp_color) +
  scale_shape_manual("Reviewed Annotations", values = spp_shape)

# Build fruit width graph.
trait_carbon_fr_wid <-
  continuous_tbl(trait_frame = spp_carbon_medi,
                 trait_name = "Mature_fruit_width_mm") %>%
  ggplot(.,
         aes(Date_md, trait_mid,
             colour = Taxon_a_posteriori,
             shape = Taxon_a_posteriori)) +
  geom_point(na.rm = TRUE, size = 3) +
  geom_smooth(method = 'lm', formula = y~x, na.rm = TRUE) +
  scale_y_continuous(name = "Mature Fruit Width (mm)", limits = c(0, 15)) +
  scale_x_date(name = "Collection Date", date_labels = "%m-%d",
               limits = as.Date(c("2019-05-01", "2019-09-01"),
                                format = "%Y-%m-%d")) +
  scale_color_manual("Reviewed Annotations", values = spp_color) +
  scale_shape_manual("Reviewed Annotations", values = spp_shape)

# Arrange graphical objects with shared legend.
lemon::grid_arrange_shared_legend(trait_carbon_fr_len, trait_carbon_fr_wid,
                                  ncol = 1, nrow = 2, position = "right")

```


```{r resultsFigure9MapVituFloriMedicinaeComplex, fig.width=8, fig.asp=1.25, fig.cap=knitr_cap}

knitr_cap <-
  paste0("Allopatric distribution of regional *Physaria* species.")

### SEINet specimen data formatted as Darwin Core Biodiversity Standard ----
# Physaria floribunda
co_fbunda <- read.csv(file =
                        "data/SEINet/Colorado_P.floribunda/occurrences.csv",
                      header = TRUE, stringsAsFactors = FALSE) %>%
  dplyr::select(scientificName, scientificNameAuthorship, genus,
                specificEpithet, taxonRank, infraspecificEpithet, identifiedBy,
                recordedBy, recordNumber, eventDate, year, stateProvince,
                county, locality, decimalLatitude, decimalLongitude,
                verbatimCoordinates, verbatimElevation) %>%
  dplyr::rename(Latitude = decimalLatitude, Longitude = decimalLongitude) %>%
  dplyr::filter(., !is.na(.[["Latitude"]]) & !is.na(.[["Longitude"]])) %>%
  dplyr::mutate(.,
                scientificName =
                  purrr::map_chr(scientificName,
                    function(taxon) {
                      gsub("var\\.|subsp\\.", "ssp.", x = taxon)
                      }))

# Physaria bellii
co_bellii <- read.csv(file =
                        "data/SEINet/Colorado_P.bellii/occurrences.csv",
                      header = TRUE, stringsAsFactors = FALSE)%>%
  dplyr::select(scientificName, scientificNameAuthorship, genus,
                specificEpithet, taxonRank, infraspecificEpithet, identifiedBy,
                recordedBy, recordNumber, eventDate, year, stateProvince,
                county, locality, decimalLatitude, decimalLongitude,
                verbatimCoordinates, verbatimElevation) %>%
  dplyr::rename(Latitude = decimalLatitude, Longitude = decimalLongitude) %>%
  dplyr::filter(., !is.na(.[["Latitude"]]) & !is.na(.[["Longitude"]]))

# Subset herbarium specimens by geographic coordinates
co_flori_vitu <-
  dplyr::filter(total_physaria,
                Longitude > -110.3874 & Longitude < -103.3562 &
                  Latitude > 36.85266 & Latitude < 42.26863)

# Build combined SEINet / herbarium specimen ggmap ----
(map_ggmap(map_df = co_flori_vitu, gg_borders = gg_borders,
            gg_map_type = "satellite",
            map_col = "Taxon_a_posteriori",
            shape_opt = "Taxon_a_posteriori",
            gg_latitude = 39.56065, gg_longitude = -106.8718) +

  # Layer coordinate points from SEINet data set of CO P. floribunda.
  geom_jitter(data = co_fbunda, show.legend = FALSE,
              mapping = aes(x = Longitude, y = Latitude,
                            colour = scientificName,
                            shape = scientificName), size = 2.75) +
  geom_jitter(data = co_bellii, show.legend = FALSE,
              mapping = aes(x = Longitude, y = Latitude,
                            colour = scientificName,
                            shape = scientificName), size = 2.75)) %>%
  map_themes(.) +
  guides(colour = guide_legend(ncol = 2, byrow = TRUE)) +
  theme(legend.direction = "vertical", legend.position = "bottom")



```

